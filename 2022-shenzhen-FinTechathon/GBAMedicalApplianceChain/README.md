# GBAMedicalApplianceChain
# 湾区药械链
## ——破解大湾区三地医疗监管差异难题的优化方案
- **团队名称**：安托山九院
- **团队成员**：郑黎彬（深圳大学），王与（深圳大学），伍诚杰（电子科技大学）
- **项目简介**：湾区药械链是基于目前“港澳药械通”政策而优化设计出的区块链平台，旨在用区块链技术解决原有的政策服务中“数据孤岛”、对境外上市许可持有人（即境外药械研发企业）政策吸引力不足等问题。项目基于数据可携带权实现患者和企业资料的可信流转，并通过属性基加密等技术实现为患者提供点对点的消息服务；构建数据交易平台吸引药械的境外药品上市许可持有人参与构建药械数据库，帮助药械审核进口，为三地居民（特别是在粤港澳大湾区内地工作、学习和生活的港澳同胞）提供已在港澳上市的药品或医疗器械，促进三地医疗用药用械等公共服务的均等化，破解“一国两制三种医疗监管体系”的痛点，推动大湾区一体化向纵深发展。
- **背景引入及痛点分析**：  
1. 在过去，由于很多药品或医疗器械在港澳上市而未在内地上市，因此很多有特殊需求的患者都会去港澳购买或使用在内地没有上市的药械。而疫情后，来回通关可能需要隔离甚至感染新冠，一般患者不愿承担这一风险。
为了满足部分患者的需要，2020年9月，国家在大湾区内试点先行“港澳药械通”，试点引进临床急需，已在香港、澳门上市，未获国家药监局批准注册，国内已注册品种无法替代的药品与医疗器械。截至目前，“港澳药械通”政策已在粤港澳大湾区内地9市扩展实施一年多，惠及千余人次。
然而在实践过程中却发现，因为“港澳药械通”只能在广东省内5家指定的医疗机构使用，这给在居住在外地的患者带来了极大的不便。由于不同医院间互为“数据孤岛”，患者在外地医院得出诊断结果后，还需要再次来到5家指定医疗机构中的某一家进行二次诊断，增加了患者的成本。其次，因为进口新药的申报只能由5家指定医疗机构向药监局提出，外地医疗机构无权向药监局申报新药的进口。除此之外，目前“港澳药械通”新药械入库后，通知的方式是在其官网或微信公众号上进行发布，而5家医院各有不同的消息发布平台。若未来指定医疗机构数量增加，患者获取消息的途径会更加繁琐，很有可能还会因此错过一些和自己有关的重要消息。因此，患者、外地医疗机构与5家指定医疗机构急需一个点对点的平台。
2. 2022年9月1日，粤港澳大湾区内地临床急需进口港澳药品医疗器械预审品种数据库系统正式上线，旨在做好指定医疗机构临床急需进口港澳药品医疗器械申报服务工作，稳步推进“港澳药械通”政策体系建设，提高急需药械相关品种研究资料可及性，缩短申请资料准备时间，提升境外上市许可持有人政策参与积极性。
	然而，由于“一国两制三法域”的客观存在，粤港澳三地医疗监管体系互不相通，患者的医疗数据也不可流通，境外上市许可持有人并不能够知道居住在内地的患者对于哪些药械是处于急需的状态，造成了一定程度上的“数据孤岛”。其次，目前的预审库虽然提供了让境外上市许可持有人上传资料的平台，将以往“政府急需药械时才找企业”转变成了“企业可以先把药械交给政府审核”，一定程度上赋予了企业主动权，但政府部门对于境外上市许可持有人主动提交资料却没有设置合理的激励措施。
除此之外，根据2022年6月20日开始实施的《粤港澳大湾区内地指定医疗机构非首次使用临床急需进口港澳药品医疗器械申报指南》（如图 1所示），政府部门（药监局和卫健委）对境外上市许可持有人提交的资料进行“并联”式的审批，其中包括药监局组织专家对药械进行评审。专家评审过程中，资料的验真对于专家决定是否引进药械非常重要。而目前“港澳药械通”政策并没有单独设计对源文件的验真，猜测应该是由专家团队以自身专业知识对内容真假进行辨别，这并不利于简化流程和加快审批。因此保证境外上市许可持有人上传文件的真实性也要是一大要务。

 <img src="https://github.com/pascalria/GBAMedicalApplianceChain/blob/main/img/1.png" width="%25" height="%25" />
 _图 1《粤港澳大湾区内地指定医疗机构非首次使用临床急需进口港澳药品医疗器械申报指南》_

- **解决思路**：

第一，对于药械的申请，我们可以将现存的相关患者信息以可信的方式收集到指定的5家医疗机构的数据库里，这样可以方便后面对所需药械下的患者数量进行一个统计。统计的意义在于让政府部门、医疗机构和境外上市许可持有人都可以明确内地现存患者的需求与数量，解决“数据孤岛”或信息不对称等问题。

第二，5家指定医疗机构之间要对收集到的患者信息形成共识，这样任何一家医疗机构申请到了新药械后便可直接查询数据库找到所有现存患者的信息，并通过属性基加密（ABE）在客户端上安全快速地给所需患者发送信息，通知其可以前来购买和使用药械。

第三，对于境外上市许可持有人提交的资料，我们可以通过香港卫生署和澳门药监局的公信力背书，对其上传资料进行可信验真，验真的意义在于加快专家评审进程。其实现思路与第一点较为类似，均是基于个人可携带权进行实现的。

第四，对于境外上市许可持有人激励不足的问题，我们可以设立一个积分数据交易平台，境外上市许可持有人根据其帮助患者数量获得积分，积分可以在药监局处换取到指定医疗机构的一些资料文件如临床资料，这些文件可以对境外上市许可持有人未来建立在内地上市运行的可行体系起到参考和帮助。

- **系统架构**：
在应用层上，患者客户端上我们设置有患者客户端注册、患者健康卡片填写、患者资料上传、患者ABE接收通知等；境外上市持有人客户端上我们设置有资料上传、积分交易平台、累计积分账户等；药监局端我们设置有
- **具体开发方案**：
1. 患者资料验证
各地的医疗机构申请加入联盟链，每家医疗机构均持有公私钥对(PK,SK)。由CA（卫健委）颁发的CA数字证书作为医疗机构的链上的身份认证凭证。CA 数字证书包含了该证书拥有者的身份、签名、有效期等。不同CA数字证书拥有者的身份在链上操作的权限也不同。对“港澳药械通”的药械有需求的患者在各地医疗机构就诊时通过客户端注册得到身份序号，即id。
患者就诊后在当地医疗机构处下载个人电子健康记录(Electronic Health Record,EHR)或电子病历（Electronic Medical Record, EMR）（如图 2所示）等检查凭证后，委托当地医疗机构将其资料哈希运算生成摘要并签名后上链。然后用5家指定的医疗机构中的任意一家的公钥加密后点对点传输，将患病情况（或需要某种药械）告知给指定医疗机构。同时指定医疗机构能够对比哈希值进行可信验真。
 
 <img src="https://github.com/pascalria/GBAMedicalApplianceChain/blob/main/img/2.jpg" width="%25" height="%25" />
 
 _图 2电子病历示意图_
 
综上所述，患者数据验证运行过程如图 3所示：

<img src="https://github.com/pascalria/GBAMedicalApplianceChain/blob/main/img/3.png" width="%25" height="%25" />

 _图 3患者资料验证运行流程_ 
 
2. **指定医疗机构共识** 

5家指定医疗机构需要通过PBFT机制形成共识，如图 4和图 5所示。由于指定医疗机构要验证明文信息真实性并统计数量，因此患者传输的资料在5家医疗机构的共识过程中均为明文形式。
具体来说：任意一家指定医疗机构在收到关于患者资料并审核确认后，将资料的Hash值和患者id等信息打包成一个交易，放入交易池。交易池中暂时存放了各个节点已提交但尚未入块的所有交易。指定医疗机构分为权威医院和从医院。权威医院由共识算法选取，权威医院负责患者信息的存储，并将存储内容与从医院达成一致。在系统初始时，生成私钥和公钥并计算相关值。当收集到足够多资料后，权威医院将交易池中的所有交易打包成一个新区块，提交给从医院，通过PBFT的预准备、准备、提交3个阶段达成共识，确认新区块的合法性后将其添加到区块链的尾部。

<img src="https://github.com/pascalria/GBAMedicalApplianceChain/blob/main/img/4.png" width="%25" height="%25" />
 _图 4指定医疗机构的系统模型_

<img src="https://github.com/pascalria/GBAMedicalApplianceChain/blob/main/img/5.png" width="%25" height="%25" />
 _图 5 指定医疗机构共识过程_
 
3. **指定医疗机构通知**

指定医疗机构申请新药械通过并且新药械已入库后，则可依据药械可使用的范围生成策略，根据患者显示在健康卡片上的信息，利用属性基加密（ABE）发送给特定的患者群体，这样可以点对点地通知患者前往指定医疗机构购买和使用药械。将患者获取消息的方式转搜索为接收，减少患者因消息源过多而导致未注意到药械可用消息的可能。
前面说到，对“港澳药械通”的药械有需求的患者在各地医疗机构就诊时通过客户端注册得到身份序号，即id；同时客户端也会要求患者根据其所选择的药械按要求填写具体情况。比如注射“抗D免疫球蛋白注射液”第一针需要满足的条件为：患者为刚好怀孕28周的“熊猫血”孕妇。系统会根据其属性内容生成患者的属性私钥。例如港大深圳医院引进了一批“抗D免疫球蛋白注射液”后在客户端上对患者群体发送信息，则其策略树如图 6所示。
 
<img src="https://github.com/pascalria/GBAMedicalApplianceChain/blob/main/img/6.png" width="%25" height="%25" />
 _图 6 注射“抗D免疫球蛋白注射液”第一针的策略树_
 
4. 境外上市许可持有人资料验证

在此合约上，香港卫生署、澳门药监局与广东省药监局、卫健委共建CA认证中心，由其颁发的CA数字证书作为监管单位和境外上市许可持有人（或者其授权的在中国境内的企业法人）在港澳数据验证合约中的身份认证凭证，其中包含该证书拥有者的数字签名、公钥信息和身份信息。
根据预审库提交文件的要求 ，具体来说，境外上市许可持有人需要提交的文件有：
	《粤港澳大湾区内地临床急需进口港澳药品品种数据库申请表》或者《粤港澳大湾区内地临床急需进口港澳医疗器械品种数据库申请表》
	《粤港澳大湾区内地临床急需进口港澳药品品种数据库资料清单》或者《粤港澳大湾区内地临床急需进口港澳医疗器械品种数据库资料清单》
	承诺书
其中在第二项的清单中，要求提供大量药械的资料，比如：
	香港或者澳门地区允许上市的批准证明文件
	药品的包装、标签、说明书样本，及产品完整实样图片
	药品不良反应概述
	临床使用综述
	人种差异使用风险评估……
等近十余项证明文件或资料。因为境外上市许可持有人已经在港澳上市，这些文件大部分已经在香港卫生署或澳门药监局提交并受其验证过。因此，境外上市许可持有人可以利用企业信息的可携带权，结合区块链并通过政府部门的公权力背书实现资料跨境数据验真。而这有利于缩短广东省药监局及其专家团队的评审压力，因为目前对境外上市许可持有人上传文件的验真主要还是基于专家团队的专业素养，而目前评审过程时间短任务重。若能在评审之前在一定程度上确定药械资料的真实性将有助于缩短评审时间并简化评审流程。
港澳数据验证与患者资料验证在思路上一脉相承，如图 7所示。具体来说，境外上市许可持有人委托香港卫生署或澳门药监局将资料文件哈希加密并用自己的私钥签名后上链；同时，境外上市许可持有人用广东省药监局的公钥加密后点对点传输给广东省药监局；广东省药监局收到数据后用自己的私钥解密文件，并将其进行哈希运算得出散列值；广东省药监局从链上下载签名后的数据，用香港卫生署或澳门药监局的公钥进行验证后，对比两个散列值是否相同，若相同则文件为真，反之为假。从而在一定程度上保证了资料文件的可信，在流程上也减少了专家评审过程中对资料以经验进行验真的工作，加快了审核进程。
值得一提的是，目前类似的项目“粤澳跨境数据验证平台”正是基于FISCO BCOS的开发的国产开源区块链底层平台进行验证。若该项目未来能够接入香港并提供数据接口的话，本项目便可以直接跨链进行数据验真，进一步加快大湾区数据要素的流通。
 
<img src="https://github.com/pascalria/GBAMedicalApplianceChain/blob/main/img/7.png" width="%25" height="%25" />
图 7 港澳数据验证运行流程

5. 积分交易

对于境外药品上市许可持有人的激励措施设置，我们的想法如图 8所示：
境外药品上市许可持有人上传资料文件完善数据库后，若药品审核通过并成功引进，则根据实际帮助患者数量发放积分，积极响应的企业可以获得额外积分。积分发放过程为药监局根据目前已有的“粤港澳大湾区临床急需进口药械流通管理系统”中上传的药械使用数据定期进行发放。属于企业自己“挖”得的累计积分不会清零，累计积分的意义在于体现企业的社会责任感，可以作为评价企业ESG质量时的重要指标之一，为未来投资者投资或政府采购时提供重要参考。获得的积分会进入积分账户，积分账户的积分可以用于交易。境外药品上市许可持有人如果就其药械在未来希望在内地注册上市，则需要在内地寻找境内代理人 。而一定数量的积分可以在广东省药监局换取其药械在指定医疗机构使用过程中产生的临床数据、生产销售、上市后研究评价、风险管理等情况的一定数量的资料文件，并可由药监局直接分享给境内代理人，帮助境内代理人快速建立起在内地运行的可行体系。

<img src="https://github.com/pascalria/GBAMedicalApplianceChain/blob/main/img/8.png" width="%25" height="%25" />
图 8 数据交易层思路

6. 商用场景及价值
	
本作品旨在破解大湾区三地医疗监管差异难题，实现公共服务的均等化，推动大湾区一体化向纵深方向发展。除了服务于社会层面，本作品也可以同商业场景有机结合，具体有两个实际应用：真实世界研究和商业保险支付。
真实世界研究（Real World Study, RWS），是对药物、医疗器械或技术在真实医疗环境/临床应用场景中产生的数据进行系统性收集，并采用循证医学、临床/药物流行病学等方法开展的研究，包括观察性研究和试验性研究。在湾区药械链上产生的数据以区块链不可篡改的特性为真实世界研究提供了真实可信且极具研究意义的大量临床数据。而这些临床数据对于真实世界研究价值十分重大的原因在于此类药械在国内并未上市，而由于触及商业机密，境外上市许可持有人不一定会将资料悉数上传给药监局，因此真实世界研究院可直接获取到的数据源极少。若“港澳药械通”政策配套湾区药械链，并将数据可信流转出售给真实世界研究院等企业或机构，此类数据不仅可以给企业或研究机构带来价值更为重大的利润，而且未来也会对我国公共卫生安全等领域也会起到理论指导的作用。
融入了区块链元素的“港澳药械通”政策也可以在商业保险下发挥重大作用。目前在“港澳药械通”进一步推广的过程中，也存在着临床急需进口使用药械价格高昂的难点和阻力，尤其是境外原研的抗肿瘤新药对于患者的经济负担较重。“港澳药械通”如果和区块链、商业保险一同设计的话一方面可以有效确保商业保险过程中的事件发生的真实性与不可篡改性，有效遏制“骗保”等问题的发生，推动“港澳药械通”与更多商业保险支付进行探索；另一方面，商业保险的加入也可以有效减轻患者的经济负担，让患者可以以更亲民的价格用药用械，更好地保障患者身体健康和生命安全。
