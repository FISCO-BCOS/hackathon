/*! 
 Build based on gin-vue-admin 
 Time : 1730113336000 */
import{s as a,a as e,r as t,o as l,c as o,e as s,w as r,g as p,b as i,K as d,L as m,h as u,k as n,E as c}from"./087AC4D233B64EB0index.js";import{E as B,a as b}from"./087AC4D233B64EB0table-column.js";import"./087AC4D233B64EB0checkbox.js";/* empty css                       *//* empty css                      */import"./087AC4D233B64EB0scrollbar.js";import"./087AC4D233B64EB0tag.js";import{a as C,E}from"./087AC4D233B64EB0form-item.js";import{E as v,a as h}from"./087AC4D233B64EB0select.js";import{E as A}from"./087AC4D233B64EB0popover.js";import{E as f}from"./087AC4D233B64EB0empty.js";/* empty css                      *//* empty css                     */import{_ as j}from"./087AC4D233B64EB0warningBar.js";import{g as y}from"./087AC4D233B64EB0autoCode.js";import{_ as D}from"./087AC4D233B64EB0_plugin-vue_export-helper.js";import"./087AC4D233B64EB0index20.js";import"./087AC4D233B64EB0index21.js";import"./087AC4D233B64EB0_Uint8Array.js";import"./087AC4D233B64EB0isEqual.js";import"./087AC4D233B64EB0debounce.js";import"./087AC4D233B64EB0_initCloneObject.js";import"./087AC4D233B64EB0castArray.js";import"./087AC4D233B64EB0_baseClone.js";import"./087AC4D233B64EB0index22.js";import"./087AC4D233B64EB0token.js";import"./087AC4D233B64EB0strings.js";import"./087AC4D233B64EB0dropdown.js";const _={class:"gva-table-box"},k={key:0},w={class:"secret"},x={key:1},g={style:{"text-align":"right","margin-top":"8px"}},V={class:"tables"},G={key:1,class:"text"},T=D({__name:"chatTable",setup(D){const T=e(null),K=t({sk:""}),S=e(""),U=async()=>{const e=await a({url:"/chatGpt/getSK",method:"get"});T.value=e.data.ok};U(),(async()=>{const a=await y();0===a.code&&(z.value=a.data.dbs)})();const q=async()=>{var e;0===(await(e=K,a({url:"/chatGpt/createSK",method:"post",data:e}))).code&&await U()},R=async()=>{0===(await a({url:"/chatGpt/deleteSK",method:"delete"})).code&&await U()},P=e({dbname:"",chat:""}),z=e([]),I=e([]),L=async()=>{const e=await(t=P.value,a({url:"/chatGpt/getTable",method:"post",data:t}));var t;0===e.code&&(I.value=e.data.results||[]),S.value=e.data.sql};return(a,e)=>{const t=n,y=c,D=f,U=A,O=C,Q=v,F=h,H=E,J=B,M=b;return l(),o("div",_,[s(j,{title:"使用GPT-3.5模型，存在一定不稳定性，成功率为50%左右，使用GPT-4可以极大提升成功率，但是费用较高。"}),T.value?(l(),o("div",x,[s(H,{model:P.value,"label-width":"120px"},{default:r((()=>[s(O,{label:"删除当前sk："},{default:r((()=>[s(U,{placement:"top",width:"160"},{reference:r((()=>[s(y,{type:"primary",link:"",icon:"delete"},{default:r((()=>e[6]||(e[6]=[p("删除")]))),_:1})])),default:r((()=>[e[7]||(e[7]=i("p",null,"确定要删除并返回吗？",-1)),i("div",g,[s(y,{type:"primary",onClick:R},{default:r((()=>e[5]||(e[5]=[p("确定")]))),_:1})])])),_:1})])),_:1}),s(O,{label:"查询db名称："},{default:r((()=>[s(F,{modelValue:P.value.dbname,"onUpdate:modelValue":e[1]||(e[1]=a=>P.value.dbname=a),placeholder:"请选择库",style:{width:"115px"}},{default:r((()=>[(l(!0),o(d,null,m(z.value,((a,e)=>(l(),u(Q,{key:e,label:a.database,value:a.database},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),s(O,{label:"查询db描述："},{default:r((()=>[s(t,{modelValue:P.value.chat,"onUpdate:modelValue":e[2]||(e[2]=a=>P.value.chat=a),autosize:{minRows:2,maxRows:4},type:"textarea",clearable:"",placeholder:"请输入对话"},null,8,["modelValue"])])),_:1}),s(O,{label:"GPT生成SQL:"},{default:r((()=>[s(t,{modelValue:S.value,"onUpdate:modelValue":e[3]||(e[3]=a=>S.value=a),autosize:{minRows:2,maxRows:4},type:"textarea",disabled:"",placeholder:"此处展示自动生成的sql"},null,8,["modelValue"])])),_:1}),s(y,{type:"primary",onClick:L},{default:r((()=>e[8]||(e[8]=[p("查询")]))),_:1})])),_:1},8,["model"]),i("div",V,[I.value.length?(l(),u(M,{key:0,ref:"multipleTable",data:I.value,style:{width:"100%"},"tooltip-effect":"dark",height:"400px"},{default:r((()=>[(l(!0),o(d,null,m(I.value[0],((a,e)=>(l(),u(J,{key:e,prop:e,label:e,"min-width":"200","show-overflow-tooltip":""},null,8,["prop","label"])))),128))])),_:1},8,["data"])):(l(),o("p",G,"请在对话框输入你需要AI帮你查询的内容：）"))])])):(l(),o("div",k,[s(t,{modelValue:K.sk,"onUpdate:modelValue":e[0]||(e[0]=a=>K.sk=a),class:"query-ipt",placeholder:"请输入您的ChatGpt SK",clearable:""},null,8,["modelValue"]),s(y,{type:"primary",onClick:q},{default:r((()=>e[4]||(e[4]=[p("保存")]))),_:1}),i("div",w,[s(D,{description:"请到gpt网站获取您的sk：https://platform.openai.com/account/api-keys"})])]))])}}},[["__scopeId","data-v-566bb723"]]);export{T as default};
