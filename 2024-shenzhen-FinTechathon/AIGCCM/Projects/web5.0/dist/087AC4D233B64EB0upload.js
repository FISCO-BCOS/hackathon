/*! 
 Build based on gin-vue-admin 
 Time : 1730113336000 */
import{a as e,S as a,o as t,c as o,b as i,e as l,w as s,g as n,t as r,D as p,T as m,j as u,k as c,E as d,V as B}from"./087AC4D233B64EB0index.js";/* empty css                       *//* empty css                          */import"./087AC4D233B64EB0tag.js";import"./087AC4D233B64EB0select.js";import"./087AC4D233B64EB0scrollbar.js";/* empty css                      */import{E as g,a as C}from"./087AC4D233B64EB0table-column.js";import"./087AC4D233B64EB0checkbox.js";/* empty css                       *//* empty css                      *//* empty css                     */import{g as v,b as E,e as f}from"./087AC4D233B64EB0image.vue_vue_type_style_index_0_scoped_4d6462c8_lang.js";import{C as j}from"./087AC4D233B64EB0index24.js";import{_ as A,U as D}from"./087AC4D233B64EB0common.js";import{f as w}from"./087AC4D233B64EB0format.js";import{_ as h}from"./087AC4D233B64EB0warningBar.js";import{_ as y}from"./087AC4D233B64EB0_plugin-vue_export-helper.js";import{E as _}from"./087AC4D233B64EB0index22.js";import{E as x}from"./087AC4D233B64EB0index25.js";import"./087AC4D233B64EB0_Uint8Array.js";import"./087AC4D233B64EB0isEqual.js";import"./087AC4D233B64EB0index20.js";import"./087AC4D233B64EB0index21.js";import"./087AC4D233B64EB0token.js";import"./087AC4D233B64EB0strings.js";import"./087AC4D233B64EB0castArray.js";import"./087AC4D233B64EB0debounce.js";import"./087AC4D233B64EB0_initCloneObject.js";import"./087AC4D233B64EB0image-viewer.js";/* empty css                       *//* empty css                        */import"./087AC4D233B64EB0image.js";import"./087AC4D233B64EB0index26.js";import"./087AC4D233B64EB0index27.js";import"./087AC4D233B64EB0cloneDeep.js";import"./087AC4D233B64EB0_baseClone.js";import"./087AC4D233B64EB0date.js";const b=(e,a)=>{var t=new Image;t.setAttribute("crossOrigin","anonymous"),t.onload=function(){var e=document.createElement("canvas");e.width=t.width,e.height=t.height,e.getContext("2d").drawImage(t,0,0,t.width,t.height);var o=e.toDataURL("image/png"),i=document.createElement("a"),l=new MouseEvent("click");i.download=a||"photo",i.href=o,i.dispatchEvent(l)},t.src=e},k={class:"gva-table-box"},U={class:"gva-btn-list"},z=["onClick"],O={class:"gva-pagination"},S=y(Object.assign({name:"Upload"},{__name:"upload",setup(y){const S=e("/api"),T=e(""),V=e(""),I=e(1),L=e(0),M=e(10),q=e({}),P=e([]),R=e=>{M.value=e,G()},F=e=>{I.value=e,G()},G=async()=>{const e=await v({page:I.value,pageSize:M.value,...q.value});0===e.code&&(P.value=e.data.list,L.value=e.data.total,I.value=e.data.page,M.value=e.data.pageSize)};G();return(e,v)=>{const y=c,H=d,J=g,K=_,N=C,Q=x,W=B;return a((t(),o("div",null,[i("div",k,[l(h,{title:"点击“文件名/备注”可以编辑文件名或者备注内容。"}),i("div",U,[l(A,{imageCommon:V.value,"onUpdate:imageCommon":v[0]||(v[0]=e=>V.value=e),onOnSuccess:G},null,8,["imageCommon"]),l(D,{imageUrl:T.value,"onUpdate:imageUrl":v[1]||(v[1]=e=>T.value=e),"file-size":512,"max-w-h":1080,onOnSuccess:G},null,8,["imageUrl"]),l(y,{modelValue:q.value.keyword,"onUpdate:modelValue":v[2]||(v[2]=e=>q.value.keyword=e),class:"keyword",placeholder:"请输入文件名或备注"},null,8,["modelValue"]),l(H,{type:"primary",icon:"search",onClick:G},{default:s((()=>v[3]||(v[3]=[n("查询")]))),_:1})]),l(N,{data:P.value},{default:s((()=>[l(J,{align:"left",label:"预览",width:"100"},{default:s((e=>[l(j,{"pic-type":"file","pic-src":e.row.faker,preview:""},null,8,["pic-src"])])),_:1}),l(J,{align:"left",label:"日期",prop:"UpdatedAt",width:"180"},{default:s((e=>[i("div",null,r(p(w)(e.row.UpdatedAt)),1)])),_:1}),l(J,{align:"left",label:"文件名/备注",prop:"name",width:"180"},{default:s((e=>[i("div",{class:"name",onClick:a=>(async e=>{m.prompt("请输入文件名或者备注","编辑",{confirmButtonText:"确定",cancelButtonText:"取消",inputPattern:/\S/,inputErrorMessage:"不能为空",inputValue:e.name}).then((async({value:a})=>{e.name=a,0===(await f(e)).code&&(u({type:"success",message:"编辑成功!"}),G())})).catch((()=>{u({type:"info",message:"取消修改"})}))})(e.row)},r(e.row.name),9,z)])),_:1}),l(J,{align:"left",label:"链接",prop:"url","min-width":"300"}),l(J,{align:"left",label:"标签",prop:"tag",width:"100"},{default:s((e=>[l(K,{type:"jpg"===e.row.tag?"primary":"success","disable-transitions":""},{default:s((()=>[n(r(e.row.tag),1)])),_:2},1032,["type"])])),_:1}),l(J,{align:"left",label:"操作",width:"160"},{default:s((e=>[l(H,{icon:"download",type:"primary",link:"",onClick:a=>{var t;(t=e.row).url.indexOf("http://")>-1||t.url.indexOf("https://")>-1?b(t.url,t.name):b(S.value+"/"+t.url,t.name)}},{default:s((()=>v[4]||(v[4]=[n("下载")]))),_:2},1032,["onClick"]),l(H,{icon:"delete",type:"primary",link:"",onClick:a=>(async e=>{m.confirm("此操作将永久删除文件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((async()=>{0===(await E(e)).code&&(u({type:"success",message:"删除成功!"}),1===P.value.length&&I.value>1&&I.value--,G())})).catch((()=>{u({type:"info",message:"已取消删除"})}))})(e.row)},{default:s((()=>v[5]||(v[5]=[n("删除")]))),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"]),i("div",O,[l(Q,{"current-page":I.value,"page-size":M.value,"page-sizes":[10,30,50,100],style:{float:"right",padding:"20px"},total:L.value,layout:"total, sizes, prev, pager, next, jumper",onCurrentChange:F,onSizeChange:R},null,8,["current-page","page-size","total"])])])])),[[W,e.fullscreenLoading,void 0,{fullscreen:!0,lock:!0}]])}}}),[["__scopeId","data-v-1ec4b466"]]);export{S as default};
