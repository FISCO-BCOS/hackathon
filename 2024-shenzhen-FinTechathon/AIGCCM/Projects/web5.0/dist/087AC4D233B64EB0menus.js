/*! 
 Build based on gin-vue-admin 
 Time : 1730113336000 */
import{a as e,X as t,o as a,c as o,b as s,e as l,w as r,g as n,t as u,F as d,f as i,d0 as c,d1 as m,j as p,d2 as B,Q as f,k as y,E as h}from"./087AC4D233B64EB0index.js";import{E as C}from"./087AC4D233B64EB0dialog.js";import"./087AC4D233B64EB0overlay.js";import{E,a as D}from"./087AC4D233B64EB0table-column.js";import"./087AC4D233B64EB0checkbox.js";/* empty css                       *//* empty css                      */import{E as v}from"./087AC4D233B64EB0scrollbar.js";import"./087AC4D233B64EB0tag.js";import{E as j}from"./087AC4D233B64EB0tree.js";/* empty css                      *//* empty css                     */import{u as A}from"./087AC4D233B64EB0authority2.js";import{g as k,s as w}from"./087AC4D233B64EB0authorityBtn.js";import{_ as I}from"./087AC4D233B64EB0_plugin-vue_export-helper.js";import"./087AC4D233B64EB0index21.js";import"./087AC4D233B64EB0index20.js";import"./087AC4D233B64EB0_Uint8Array.js";import"./087AC4D233B64EB0isEqual.js";import"./087AC4D233B64EB0debounce.js";import"./087AC4D233B64EB0_initCloneObject.js";import"./087AC4D233B64EB0token.js";import"./087AC4D233B64EB0index30.js";const b={class:"sticky top-0.5 z-10 bg-white"},g={class:"tree-content clear-both"},_={class:"custom-tree-node"},x={key:0},R={class:"dialog-footer"},V=I(Object.assign({name:"Menus"},{__name:"menus",props:{row:{default:function(){return{}},type:Object}},emits:["changeRow"],setup(I,{expose:V,emit:N}){const O=I,U=N,S=e(""),T=e([]),q=e([]),z=e(!1),F=e({children:"children",label:function(e){return e.meta.title}});(async()=>{const e=await c();T.value=e.data.menus;const t=(await m({authorityId:O.row.authorityId})).data.menus,a=[];t.forEach((e=>{t.some((t=>t.parentId===e.menuId))||a.push(Number(e.menuId))})),q.value=a})();const M=()=>{z.value=!0},Q=e(null),X=async()=>{const e=Q.value.getCheckedNodes(!1,!0);0===(await B({menus:e,authorityId:O.row.authorityId})).code&&p({type:"success",message:"菜单设置成功!"})};V({enterAndNext:()=>{X()},needConfirm:z});const G=e(!1),H=e([]),J=e([]),K=e();let L="";const P=e=>{J.value=e},W=e=>{G.value=!0,H.value=e.menuBtn},Y=()=>{G.value=!1},Z=async()=>{const e=J.value.map((e=>e.ID));0===(await w({menuID:L,selected:e,authorityId:O.row.authorityId})).code&&(p({type:"success",message:"设置成功"}),G.value=!1)},$=(e,t)=>!e||-1!==t.meta.title.indexOf(e);return t(S,(e=>{Q.value.filter(e)})),(e,t)=>{const c=y,m=h,B=j,w=v,V=E,N=D,z=C;return a(),o("div",null,[s("div",b,[l(c,{modelValue:S.value,"onUpdate:modelValue":t[0]||(t[0]=e=>S.value=e),class:"w-3/5",placeholder:"筛选"},null,8,["modelValue"]),l(m,{class:"float-right",type:"primary",onClick:X},{default:r((()=>t[2]||(t[2]=[n("确 定")]))),_:1})]),s("div",g,[l(w,null,{default:r((()=>[l(B,{ref_key:"menuTree",ref:Q,data:T.value,"default-checked-keys":q.value,props:F.value,"default-expand-all":"","highlight-current":"","node-key":"ID","show-checkbox":"","filter-node-method":$,onCheck:M},{default:r((({node:e,data:c})=>[s("span",_,[s("span",null,u(e.label),1),s("span",null,[l(m,{type:"primary",link:"",style:d({color:I.row.defaultRouter===c.name?"#E6A23C":"#85ce61"}),disabled:!e.checked,onClick:()=>(async e=>{const t=await A({authorityId:O.row.authorityId,AuthorityName:O.row.authorityName,parentId:O.row.parentId,defaultRouter:e.name});0===t.code&&(p({type:"success",message:"设置成功"}),U("changeRow","defaultRouter",t.data.authority.defaultRouter))})(c)},{default:r((()=>[n(u(I.row.defaultRouter===c.name?"首页":"设为首页"),1)])),_:2},1032,["style","disabled","onClick"])]),c.menuBtn.length?(a(),o("span",x,[l(m,{type:"primary",link:"",onClick:()=>(async e=>{L=e.ID;const t=await k({menuID:L,authorityId:O.row.authorityId});0===t.code&&(W(e),await f(),t.data.selected&&t.data.selected.forEach((e=>{H.value.some((t=>{t.ID===e&&K.value.toggleRowSelection(t,!0)}))})))})(c)},{default:r((()=>t[3]||(t[3]=[n(" 分配按钮 ")]))),_:2},1032,["onClick"])])):i("",!0)])])),_:1},8,["data","default-checked-keys","props"])])),_:1})]),l(z,{modelValue:G.value,"onUpdate:modelValue":t[1]||(t[1]=e=>G.value=e),title:"分配按钮","destroy-on-close":""},{footer:r((()=>[s("div",R,[l(m,{onClick:Y},{default:r((()=>t[4]||(t[4]=[n("取 消")]))),_:1}),l(m,{type:"primary",onClick:Z},{default:r((()=>t[5]||(t[5]=[n("确 定")]))),_:1})])])),default:r((()=>[l(N,{ref_key:"btnTableRef",ref:K,data:H.value,"row-key":"ID",onSelectionChange:P},{default:r((()=>[l(V,{type:"selection",width:"55"}),l(V,{label:"按钮名称",prop:"name"}),l(V,{label:"按钮备注",prop:"desc"})])),_:1},8,["data"])])),_:1},8,["modelValue"])])}}}),[["__scopeId","data-v-dff48283"]]);export{V as default};
